{"remainingRequest":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/software/vue_middleware_platform/src/components/page/rabbitmqManagement/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/data/software/vue_middleware_platform/src/components/page/rabbitmqManagement/index.vue","mtime":1607932802580},{"path":"/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js","mtime":1607932810881},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1607932810847},{"path":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js","mtime":1607932810803}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getRabbitmqServerList, createRabbitmqServer, deleteRabbitmqServer, updateRabbitmqServer } from '@/api/rabbitmq_server'\nimport ServerList from './list'\nimport ServerForm from './form'\n\nexport default {\n  name: 'rabbitmqManagement',\n  components: { ServerList, ServerForm },\n  data() {\n    return {\n      serverid: '',\n      vauleUsername: '',\n      vaulePassword: '',\n      server: [],\n      multipleSelection: [],\n      serverOption: [],\n      dialogVisibleCreate: false,\n      dialogVisibleUpdate: false,\n      updateServerInfo: {},\n      serverInfo: {},\n      // detailForm: {},\n      createString: '立即创建',\n      updateString: '立即更新',\n      totalNum: 0,\n      currentPage1: 1,\n      params: {\n        page: 1,\n        keywords: '',\n        page_size: 10\n      },\n      cluster_name_list: [],\n      cluster_name_options: []\n    }\n  },\n  created() {\n    this.fetchData()\n  },\n  methods: {\n    fetchData() {\n      getRabbitmqServerList(this.params).then(\n          // 获取rabbitmq集群列表\n          res => {\n            this.server = res.results\n            this.totalNum = res.count\n          },\n          err => {\n            this.$message({\n              type: 'error',\n              message: err\n            })\n          }\n      )\n    },\n    handleSubmitCreate(value) {\n      // 创建服务器\n      createRabbitmqServer(value).then(\n          () => {\n            this.fetchData()\n            this.dialogVisibleCreate = false\n            this.$refs.serverCreateForm.form.resetFields().catch(err => {})\n            this.$message({\n              type: 'success',\n              message: '创建成功'\n            })\n          },\n          error => {\n            this.$message({\n              type: 'error',\n              message: error\n            })\n          }\n      )\n    },\n    handleSubmitUpdate(value) {\n      // 更新服务器\n      updateRabbitmqServer(value).then(\n          () => {\n            this.fetchData()\n            this.dialogVisibleUpdate = false\n            this.$message({\n              type: 'success',\n              message: '更新成功'\n            })\n          },\n          err => {\n            this.$message({\n              type: 'error',\n              message: err.response\n            })\n          })\n    },\n    handleDialogCreate() {\n      // 弹出服务器新增弹框\n      this.dialogVisibleCreate = true\n    },\n    handleDialogUpdate(server_obj) {\n      this.serverInfo = server_obj\n      this.dialogVisibleUpdate = true\n    },\n    closedUpdateDialog() {\n      // this.reset = false\n    },\n    handleDeleteServer(id) {\n      // 删除Server\n      deleteRabbitmqServer(id).then(\n          () => {\n            if (this.totalNum % this.params.page_size === 1) {\n              this.params.page = this.params.page - 1\n            }\n            this.fetchData()\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            })\n          },\n          err => {\n            this.$message({\n              type: 'error',\n              message: err\n            })\n          }\n      )\n    },\n    handleOpertionServer(params) {\n      // 打开rabbitmq-management页面进行操作\n      window.open(params.url,'_blank')\n    },\n    handleCopyUsername(username) {\n      const input = document.createElement('input') // 新增一个input\n      input.style.position = 'relative' // 将它隐藏（注意不能使用display或者visibility，否则粘贴不上）\n      input.style.zIndex = '-9'\n      document.body.appendChild(input) // 追加\n      input.value = username // 设置文本框的内容\n      input.select() // 选中文本\n      document.execCommand('copy') // 执行浏览器复制命令\n      document.body.removeChild(input)\n      this.$message({\n        type: 'success',\n        message: '账户复制成功'\n      });\n    },\n    handleCopyPassword(password) {\n      const input = document.createElement('input') // 新增一个input\n      input.style.position = 'relative' // 将它隐藏（注意不能使用display或者visibility，否则粘贴不上）\n      input.style.zIndex = '-9'\n      document.body.appendChild(input) // 追加\n      input.value = password // 设置文本框的内容\n      input.select() // 选中文本\n      document.execCommand('copy') // 执行浏览器复制命令\n      document.body.removeChild(input)\n      this.$message({\n        type: 'success',\n        message: '密码复制成功'\n      });\n    },\n    handleCurrentChange(val) {\n      // 分页\n      this.params.page = val\n      this.fetchData()\n    },\n    handleSizeChange(val) {\n      // 改变分页大小\n      this.params.page_size = val\n      this.fetchData()\n    },\n    handleCreateCancel() {\n      // 取消创建\n      this.dialogVisibleCreate = false\n      this.fetchData()\n    },\n    handleUpdateCancel() {\n      // 取消更新\n      this.dialogVisibleUpdate = false\n      this.fetchData()\n    },\n    handleFilter() {\n      // 搜索\n      this.params.page = 1\n      this.fetchData()\n    },\n    handleSelectionChange(val) {\n      // 获取表格多选的值\n      this.multipleSelection = val\n    },\n    handleMultiDeleteServer() {\n      // 批量删除\n      if ((this.totalNum - this.multipleSelection.length) % this.params.page_size === 0) {\n        this.params.page = this.params.page - 1\n      }\n      this.multipleSelection.forEach(\n          (item) => {\n            deleteServer(item.id).then(\n                () => {\n                  this.fetchData()\n                  this.$message({\n                    type: 'success',\n                    message: '删除成功!'\n                  })\n                })\n          },\n          err => {\n            this.$message({\n              type: 'error',\n              message: err\n            })\n          })\n      this.$refs.serverListTable.$refs.listTable.clearSelection()\n    }\n  }\n}\n\n",null]}