{"remainingRequest":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/software/vue_middleware_platform/src/components/page/audit/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/data/software/vue_middleware_platform/src/components/page/audit/login/index.vue","mtime":1610812134571},{"path":"/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js","mtime":1609060265632},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1609060265603},{"path":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js","mtime":1609060265552}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getLoginList } from '@/api/audit'\nimport { formatJson } from '@/utils'\nexport default {\n    name: 'Logininfor',\n    data() {\n        return {\n            // 遮罩层\n            loading: true,\n            // 选中数组\n            ids: [],\n            // 非多个禁用\n            multiple: true,\n            // 总条数\n            total: 0,\n            // 表格数据\n            list: [],\n            // 状态数据字典\n            statusOptions: [],\n            // 查询参数\n            queryParams: {\n                page: 1,\n                page_size: 10,\n                remote_ip: undefined,\n                username: undefined,\n                login_type: undefined,\n                start_date: undefined,\n                end_date: undefined,\n            },\n            start_date: '',\n            end_date: '',\n            pickerOptions: {\n                disabledDate(time) {\n                    return time.getTime() > Date.now();\n                },\n                shortcuts: [{\n                    text: '今天',\n                    onClick(picker) {\n                        picker.$emit('pick', new Date());\n                    }\n                }, {\n                    text: '昨天',\n                    onClick(picker) {\n                        const date = new Date();\n                        date.setTime(date.getTime() - 3600 * 1000 * 24);\n                        picker.$emit('pick', date);\n                    }\n                }, {\n                    text: '一周前',\n                    onClick(picker) {\n                        const date = new Date();\n                        date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);\n                        picker.$emit('pick', date);\n                    }\n                }]\n            },\n        }\n    },\n    created() {\n        this.getList()\n        // this.getDicts('sys_common_status').then(response => {\n        //     this.statusOptions = response.data\n        // })\n    },\n    methods: {\n        addDateTime(val) {\n\n            let dateTime = new Date(val);\n\n            dateTime = dateTime.setDate(dateTime.getDate() + 1);\n\n            dateTime = new Date(dateTime);\n\n            return dateTime.toLocaleDateString();\n\n        },\n        /** 查询登录日志列表 */\n        getList() {\n            this.loading = true\n            if (this.start_date && this.end_date) {\n                this.queryParams.start_date = this.start_date\n                this.queryParams.end_date = this.addDateTime(this.end_date)\n            }\n            else {\n                this.queryParams.start_date = undefined\n                this.queryParams.end_date = undefined\n            }\n            getLoginList(this.queryParams).then(response => {\n                    this.list = response.results\n                    for (let i in this.list) {\n                        this.list[i]['num'] = parseInt(i) + 1\n                    }\n                    this.total = response.count\n                    this.loading = false\n                }\n            )\n\n        },\n        /** 搜索按钮操作 */\n        handleQuery() {\n            this.queryParams.page = 1\n            this.getList()\n        },\n        /** 重置按钮操作 */\n        resetQuery() {\n            this.dateRange = []\n            this.start_date = ''\n            this.end_date = ''\n            this.resetForm('queryForm')\n            this.handleQuery()\n        },\n        /** 转换登录状态为中文 */\n        formatLoginType(row, column) {\n            if (row.login_type === 0) {\n                return '登录'\n            }\n            else if (row.login_type === 1) {\n                return '登出'\n            }\n            else if (row.login_type === 2) {\n                return '登录失败'\n            }\n            else {\n                return '位置状态'\n            }\n        },\n        /** 导出按钮操作 */\n        handleExport() {\n            // const queryParams = this.queryParams\n            this.$confirm('是否确认导出现在的登录日志表单?', '警告', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.downloadLoading = true\n                import('@/utils/Export2Excel').then(excel => {\n                    const tHeader = ['编号',  '用户编号','用户名称', '登陆IP',  '登陆状态', '登陆日期']\n                    const filterVal = ['num', 'user_id', 'username', 'remote_ip', 'login_type', 'datetime']\n                    const list = this.list\n                    const data = formatJson(filterVal, list)\n                    excel.export_json_to_excel({\n                        header: tHeader,\n                        data,\n                        filename: '登陆日志',\n                        autoWidth: true, // Optional\n                        bookType: 'xlsx' // Optional\n                    })\n                    this.downloadLoading = false\n                })\n            })\n        }\n    }\n}\n",null]}