{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-97ac782c\"],{2612:function(e,t,a){\"use strict\";a.d(t,\"d\",(function(){return r})),a.d(t,\"b\",(function(){return i})),a.d(t,\"e\",(function(){return s})),a.d(t,\"c\",(function(){return l})),a.d(t,\"f\",(function(){return u})),a.d(t,\"a\",(function(){return o}));var n=a(\"b775\");function r(e){return Object(n[\"a\"])({url:\"/users/\",method:\"get\",params:e})}function i(e){return Object(n[\"a\"])({url:\"/users/\",method:\"post\",data:e})}function s(e){return Object(n[\"a\"])({url:\"/users/\"+e.id+\"/\",method:\"patch\",data:e})}function l(e){return Object(n[\"a\"])({url:\"/users/\"+e+\"/\",method:\"delete\"})}function u(e,t){return Object(n[\"a\"])({url:\"/usergroup/\"+e+\"/\",method:\"patch\",data:t})}function o(e,t){return Object(n[\"a\"])({url:\"/chuserpasswd/\"+e+\"/\",method:\"put\",data:t})}},\"77c4\":function(e,t,a){\"use strict\";a.d(t,\"b\",(function(){return r})),a.d(t,\"a\",(function(){return i})),a.d(t,\"c\",(function(){return s}));var n=a(\"b775\");function r(e){return Object(n[\"a\"])({url:\"/audit/login/\",method:\"get\",params:e})}function i(e){return Object(n[\"a\"])({url:\"/audit/crud/\",method:\"get\",params:e})}function s(e){return Object(n[\"a\"])({url:\"/audit/request/\",method:\"get\",params:e})}},eb69:function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"el-card\",{staticClass:\"box-card\"},[a(\"el-form\",{ref:\"queryForm\",attrs:{model:e.queryParams,inline:!0,\"label-width\":\"68px\"}},[a(\"el-form-item\",{attrs:{label:\"操作类型\",prop:\"event_type\"}},[a(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:e.event_type_value,callback:function(t){e.event_type_value=t},expression:\"event_type_value\"}},e._l(e.event_type_options,(function(e){return a(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a(\"el-form-item\",{attrs:{label:\"用户名称\",prop:\"username\"}},[a(\"el-input\",{staticStyle:{width:\"240px\"},attrs:{placeholder:\"请输入用户名称\",clearable:\"\",size:\"small\"},model:{value:e.username,callback:function(t){e.username=t},expression:\"username\"}})],1),a(\"div\",{staticClass:\"block\"},[a(\"span\",{staticClass:\"demonstration\"},[e._v(\"开始时间  \")]),a(\"el-date-picker\",{attrs:{align:\"right\",type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"选择日期\",\"picker-options\":e.pickerOptions},model:{value:e.start_date,callback:function(t){e.start_date=t},expression:\"start_date\"}}),a(\"span\",{staticClass:\"demonstration\"},[e._v(\"  结束时间  \")]),a(\"el-date-picker\",{attrs:{align:\"right\",type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"选择日期\",\"picker-options\":e.pickerOptions},model:{value:e.end_date,callback:function(t){e.end_date=t},expression:\"end_date\"}}),e._l(e.statusOptions,(function(e){return a(\"el-option\",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),a(\"span\",{staticClass:\"span\"},[e._v(\"  \")]),a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\",size:\"mini\"},on:{click:e.handleQuery}},[e._v(\"搜索\")]),a(\"el-button\",{attrs:{icon:\"el-icon-refresh\",size:\"mini\"},on:{click:e.resetQuery}},[e._v(\"重置\")])],1)],2)],1),a(\"el-row\",{staticClass:\"mb8\",attrs:{gutter:10}},[a(\"el-col\",{attrs:{span:1.5}},[a(\"el-button\",{attrs:{type:\"warning\",icon:\"el-icon-download\",size:\"mini\"},on:{click:e.handleExport}},[e._v(\"导出\")])],1)],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],attrs:{data:e.list}},[a(\"el-table-column\",{attrs:{label:\"序号\",width:\"50\",align:\"center\",prop:\"num\"}}),a(\"el-table-column\",{attrs:{label:\"操作类型\",width:\"160\",align:\"center\",prop:\"event_type\",formatter:e.formateventType}}),a(\"el-table-column\",{attrs:{label:\"表主键\",align:\"center\",prop:\"object_repr\",width:\"100\"}}),a(\"el-table-column\",{attrs:{label:\"操作信息\",width:\"400\",align:\"center\",prop:\"object_json_repr\"}}),a(\"el-table-column\",{attrs:{label:\"更新字段\",align:\"center\",prop:\"changed_fields\",width:\"150\"}}),a(\"el-table-column\",{attrs:{label:\"操作时间\",align:\"center\",prop:\"datetime\",width:\"250\"}}),a(\"el-table-column\",{attrs:{label:\"用户名\",align:\"center\",prop:\"user_id\",width:\"100\",formatter:e.formatuserID}})],1),a(\"pagination\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.total>0,expression:\"total>0\"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.page_size},on:{\"update:page\":function(t){return e.$set(e.queryParams,\"page\",t)},\"update:limit\":function(t){return e.$set(e.queryParams,\"page_size\",t)},pagination:e.getList}})],1)},r=[],i=a(\"77c4\"),s=a(\"2612\"),l=a(\"ed08\"),u={name:\"DBCRUDinfor\",data:function(){return{loading:!0,ids:[],multiple:!0,username:\"\",total:0,list:[],userList:[],statusOptions:[],queryParams:{page:1,page_size:10,event_type:void 0,user_id:void 0},event_type_options:[{value:\"1\",label:\"CREATE\"},{value:\"2\",label:\"UPDATE\"},{value:\"3\",label:\"DELETE\"},{value:\"4\",label:\"Many-to-Many CHANGE\"},{value:\"5\",label:\"Reverse Many-to-Many Change\"}],event_type_value:\"\"}},created:function(){this.getUser(),this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(i[\"a\"])(this.queryParams).then((function(t){for(var a in e.list=t.results,e.list)e.list[a][\"num\"]=parseInt(a)+1;e.total=t.count,e.loading=!1}))},getUser:function(){var e=this;Object(s[\"d\"])().then((function(t){e.userList=t.results}))},handleQuery:function(){for(var e in this.queryParams.page=1,this.userList)this.username===this.userList[e][\"username\"]&&(this.queryParams.user_id=this.userList[e][\"id\"]);this.queryParams.event_type=this.event_type_value,this.getList()},resetQuery:function(){this.dateRange=[],this.event_type_value=\"\",this.username=\"\",this.queryParams.event_type=\"\",this.queryParams.user_id=\"\",this.handleQuery()},formateventType:function(e,t){return 1===e.event_type?\"CREATE\":2===e.event_type?\"UPDATE\":3===e.event_type?\"DELETE\":4===e.event_type?\"Many-to-Many CHANGE\":5===e.event_type?\"Reverse Many-to-Many Change\":void 0},formatuserID:function(e,t){var a=\"\";for(var n in this.userList)e.user_id===this.userList[n][\"id\"]&&(a=this.userList[n][\"username\"]);return a},handleExport:function(){var e=this;this.$confirm(\"是否确认导出现在的数据库操作记录表单?\",\"警告\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){e.downloadLoading=!0,a.e(\"chunk-5949f95f\").then(a.bind(null,\"8530\")).then((function(t){var a=[\"编号\",\"用户编号\",\"用户名称\",\"登陆IP\",\"登陆状态\",\"登陆日期\"],n=[\"num\",\"user_id\",\"username\",\"remote_ip\",\"login_type\",\"datetime\"],r=e.list,i=Object(l[\"a\"])(n,r);t.export_json_to_excel({header:a,data:i,filename:\"DB操作日志\",autoWidth:!0,bookType:\"xlsx\"}),e.downloadLoading=!1}))}))}}},o=u,c=a(\"2877\"),d=Object(c[\"a\"])(o,n,r,!1,null,null,null);t[\"default\"]=d.exports}}]);","extractedComments":[]}