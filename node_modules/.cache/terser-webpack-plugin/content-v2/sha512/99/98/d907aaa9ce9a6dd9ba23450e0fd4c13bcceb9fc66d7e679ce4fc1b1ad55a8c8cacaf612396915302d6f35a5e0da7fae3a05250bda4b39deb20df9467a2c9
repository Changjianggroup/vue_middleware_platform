{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-b3ac95aa\"],{\"4bf5\":function(e,t,r){\"use strict\";r(\"7fed\")},7711:function(e,t,r){\"use strict\";r(\"e25a\")},\"78ad\":function(e,t,r){},\"7fed\":function(e,t,r){},\"81b8\":function(e,t,r){\"use strict\";r(\"78ad\")},\"9f82\":function(e,t,r){\"use strict\";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",[r(\"div\",{staticClass:\"crumbs\"},[r(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[r(\"el-breadcrumb-item\",[r(\"i\",{staticClass:\"el-icon-lx-emoji\"}),e._v(\"redis集群管理\")])],1)],1),r(\"div\",{staticClass:\"container\"},[r(\"el-row\",{attrs:{gutter:20}},[r(\"el-col\",{attrs:{span:3,offset:1}},[r(\"div\",{staticClass:\"grid-content bg-purple\"},[r(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:e.handleDialogCreate}},[e._v(\"新增redis集群\")])],1)]),r(\"el-col\",{attrs:{span:3}},[r(\"div\",{staticClass:\"grid-content bg-purple\"})]),r(\"el-col\",{attrs:{span:6}},[r(\"div\",{staticClass:\"grid-content bg-purple\"})]),r(\"el-col\",{attrs:{span:3}},[r(\"div\",{staticClass:\"grid-content bg-purple\"})])],1),r(\"server-list\",{ref:\"serverListTable\",attrs:{values:e.server},on:{mulselect:e.handleSelectionChange,edit:e.handleDialogUpdate,delete:e.handleDeleteServer,operation:e.handleOpertionServer}}),r(\"el-dialog\",{attrs:{visible:e.dialogVisibleCreate,title:\"新增服务器\",width:\"40%\"},on:{\"update:visible\":function(t){e.dialogVisibleCreate=t}}},[r(\"server-form\",{ref:\"serverCreateForm\",attrs:{bname:e.createString},on:{submit:e.handleSubmitCreate,cancel:e.handleCreateCancel}})],1),r(\"el-dialog\",{attrs:{visible:e.dialogVisibleUpdate,title:\"修改服务器信息\",width:\"40%\"},on:{\"update:visible\":function(t){e.dialogVisibleUpdate=t},closed:e.closedUpdateDialog}},[r(\"server-form\",{ref:\"serverUpdateForm\",attrs:{form:e.serverInfo,bname:e.updateString},on:{submit:e.handleSubmitUpdate,cancel:e.handleUpdateCancel}})],1),r(\"el-row\",{staticClass:\"bottom-class\"},[r(\"el-col\",{attrs:{span:1}},[r(\"div\",{staticClass:\"grid-content bg-purple sel-count\"},[e._v(\"\\n          \"+e._s(e.multipleSelection.length)+\" 选择\\n        \")])]),r(\"el-col\",{attrs:{span:1}},[r(\"div\",{staticClass:\"grid-content bg-purple\"},[r(\"el-button\",{attrs:{type:\"danger\",size:\"mini\"},on:{click:e.handleMultiDeleteServer}},[e._v(\"删除\")])],1)]),r(\"el-col\",{attrs:{span:8,offset:6}},[r(\"div\",{staticClass:\"pagination\"},[r(\"el-pagination\",{attrs:{\"current-page\":e.currentPage1,\"page-sizes\":[10,20,100,200],total:e.totalNum,layout:\"total, sizes, prev, pager, next, jumper\"},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)])],1)],1)])},a=[],n=(r(\"ac6a\"),r(\"f3e2\"),r(\"b81b\")),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",{staticClass:\"server-list\"},[r(\"el-table\",{ref:\"listTable\",staticStyle:{width:\"100%\"},attrs:{data:e.values},on:{\"selection-change\":e.schange}},[r(\"el-table-column\",{attrs:{type:\"selection\",width:\"35\"}}),r(\"el-table-column\",{attrs:{type:\"expand\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"el-form\",{staticClass:\"demo-table-expand\",attrs:{\"label-position\":\"left\",inline:\"\"}},[r(\"el-form-item\",{attrs:{label:\"id:\"}},[r(\"span\",[e._v(e._s(t.row.id))])]),r(\"el-form-item\",{attrs:{label:\"redis集群名:\"}},[r(\"span\",[e._v(e._s(t.row.cluster_name))])]),r(\"el-form-item\",{attrs:{label:\"host列表:\"}},[r(\"span\",[e._v(e._s(t.row.hosts))])]),r(\"el-form-item\",{attrs:{label:\"描述:\"}},[r(\"span\",[e._v(e._s(t.row.description))])])],1)]}}])}),r(\"el-table-column\",{attrs:{label:\"id\",\"min-width\":\"20\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"span\",[e._v(e._s(t.row.id))])]}}])}),r(\"el-table-column\",{attrs:{label:\"redis集群名\",\"min-width\":\"100\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"span\",[e._v(e._s(t.row.cluster_name))])]}}])}),r(\"el-table-column\",{attrs:{label:\"hosts列表\",\"min-width\":\"220\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"span\",[e._v(e._s(t.row.hosts))])]}}])}),r(\"el-table-column\",{attrs:{label:\"集群描述\",\"min-width\":\"100\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"span\",[e._v(e._s(t.row.description))])]}}])}),r(\"el-table-column\",{attrs:{label:\"控制\",\"min-width\":\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[r(\"el-button\",{attrs:{size:\"mini\"},on:{click:function(r){return e.serverEdit(t.row)}}},[e._v(\"编辑\")]),r(\"el-button\",{attrs:{size:\"mini\",type:\"success\"},on:{click:function(r){return e.serverOperation(t.row)}}},[e._v(\"操作\")]),r(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(r){return e.serverDelete(t.row)}}},[e._v(\"删除\")])]}}])})],1)],1)},o=[],l={name:\"ServerList\",props:{values:{type:Array,default:function(){return[]}},mulselect:{type:Array,default:function(){return[]}}},methods:{schange:function(e){this.$emit(\"mulselect\",e)},serverEdit:function(e){this.$emit(\"edit\",e)},serverDelete:function(e){var t=this;this.$confirm(\"此操作将删除该\".concat(e.cluster_name,\" 集群记录, 是否继续?\"),\"删除redis集群\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){t.$emit(\"delete\",e.id)})).catch((function(){t.$message({type:\"info\",message:\"已取消删除\"})}))},serverOperation:function(e){this.$emit(\"operation\",e.id)}}},c=l,u=(r(\"4bf5\"),r(\"2877\")),d=Object(u[\"a\"])(c,i,o,!1,null,\"d79fa59a\",null),p=d.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",[r(\"el-form\",{ref:\"form\",staticClass:\"server-form\",attrs:{model:e.form,rules:e.rules,\"label-width\":\"120px\"}},[r(\"el-form-item\",{attrs:{label:\"redis集群名\",prop:\"cluster_name\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入redis集群名\"},model:{value:e.form.cluster_name,callback:function(t){e.$set(e.form,\"cluster_name\",t)},expression:\"form.cluster_name\"}})],1),r(\"el-form-item\",{attrs:{label:\"redis host列表\",prop:\"hosts\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入hosts列表，如['ip1:port1','ip2:port2']这种形式\"},model:{value:e.form.hosts,callback:function(t){e.$set(e.form,\"hosts\",t)},expression:\"form.hosts\"}})],1),r(\"el-form-item\",{attrs:{label:\"访问密码\",prop:\"password\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入集群访问密码\"},model:{value:e.form.password,callback:function(t){e.$set(e.form,\"password\",t)},expression:\"form.password\"}})],1),r(\"el-form-item\",{attrs:{label:\"集群描述\",prop:\"description\"}},[r(\"el-input\",{attrs:{placeholder:\"描述\"},model:{value:e.form.description,callback:function(t){e.$set(e.form,\"description\",t)},expression:\"form.description\"}})],1),r(\"el-form-item\",{staticClass:\"button-right\"},[r(\"el-button\",{attrs:{size:\"small\"},on:{click:e.cancelForm}},[e._v(\"取消\")]),r(\"el-button\",{attrs:{size:\"small\",type:\"primary\"},on:{click:e.submitForm}},[e._v(e._s(e.bname))])],1)],1)],1)},f=[],h={name:\"ServerForm\",props:{form:{type:Object,default:function(){return{cluster_name:\"\",hosts:\"\",password:\"\",description:\"\"}}},bname:{type:String,required:!0}},data:function(){return{rules:{cluster_name:[{required:!0,message:\"请输入redis集群名字\",trigger:\"blur\"}],hosts:[{required:!0,message:\"请输入redis hosts列表\",trigger:\"blur\"},{validator:function(e,t,r){!1===/^\\[('(\\d{1,3}\\.){3}\\d{1,3}:\\d{1,5}'\\,?)+\\]$/.test(t)?r(new Error(\"请按要求输入redis列表，要求['ip1:port1','ip2:port2',...]\")):r()},trigger:\"blur\"}],password:[{required:!0,message:\"请输入redis访问密码\",trigger:\"blur\"}],description:[{max:255,message:\"长度不能超过255个字符\",trigger:\"blur\"}]}}},methods:{submitForm:function(){var e=this;this.$refs.form.validate((function(t){t&&e.$emit(\"submit\",e.form)}))},cancelForm:function(){this.$emit(\"cancel\")}}},b=h,g=(r(\"7711\"),Object(u[\"a\"])(b,m,f,!1,null,\"4abaaf95\",null)),v=g.exports,_={name:\"redisManagement\",components:{ServerList:p,ServerForm:v},data:function(){return{serverid:\"\",server:[],multipleSelection:[],manufactoryOption:[],serverOption:[],dialogVisibleCreate:!1,dialogVisibleUpdate:!1,updateServerInfo:{},serverInfo:{},createString:\"立即创建\",updateString:\"立即更新\",totalNum:0,currentPage1:1,params:{page:1,keywords:\"\",page_size:10},cluster_name_list:[],cluster_name_options:[]}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;Object(n[\"i\"])(this.params).then((function(t){e.server=t.results,e.totalNum=t.count}),(function(t){e.$message({type:\"error\",message:t})}))},handleSubmitCreate:function(e){var t=this;Object(n[\"d\"])(e).then((function(){t.fetchData(),t.dialogVisibleCreate=!1,t.$refs.serverCreateForm.form.resetFields().catch((function(e){})),t.$message({type:\"success\",message:\"创建成功\"})}),(function(e){t.$message({type:\"error\",message:e})}))},handleSubmitUpdate:function(e){var t=this;Object(n[\"l\"])(e).then((function(){t.fetchData(),t.dialogVisibleUpdate=!1,t.$message({type:\"success\",message:\"更新成功\"})}),(function(e){t.$message({type:\"error\",message:e.response})}))},handleDialogCreate:function(){this.dialogVisibleCreate=!0},handleDialogUpdate:function(e){this.serverInfo=e,this.dialogVisibleUpdate=!0},closedUpdateDialog:function(){},handleDeleteServer:function(e){var t=this;Object(n[\"f\"])(e).then((function(){t.totalNum%t.params.page_size===1&&(t.params.page=t.params.page-1),t.fetchData(),t.$message({type:\"success\",message:\"删除成功!\"})}),(function(e){t.$message({type:\"error\",message:e})}))},handleOpertionServer:function(e){this.$store.state.redis.server_id=e,this.$router.push({path:\"/redis/request\"})},handleCurrentChange:function(e){this.params.page=e,this.fetchData()},handleSizeChange:function(e){this.params.page_size=e,this.fetchData()},handleCreateCancel:function(){this.dialogVisibleCreate=!1,this.fetchData()},handleUpdateCancel:function(){this.dialogVisibleUpdate=!1,this.fetchData()},handleFilter:function(){this.params.page=1,this.fetchData()},handleSelectionChange:function(e){this.multipleSelection=e},handleMultiDeleteServer:function(){var e=this;(this.totalNum-this.multipleSelection.length)%this.params.page_size===0&&(this.params.page=this.params.page-1),this.multipleSelection.forEach((function(t){Object(n[\"f\"])(t.id).then((function(){e.fetchData(),e.$message({type:\"success\",message:\"删除成功!\"})}))}),(function(t){e.$message({type:\"error\",message:t})})),this.$refs.serverListTable.$refs.listTable.clearSelection()}}},y=_,C=(r(\"81b8\"),Object(u[\"a\"])(y,s,a,!1,null,\"114a8cfe\",null));t[\"default\"]=C.exports},b81b:function(e,t,r){\"use strict\";r.d(t,\"i\",(function(){return a})),r.d(t,\"d\",(function(){return n})),r.d(t,\"f\",(function(){return i})),r.d(t,\"l\",(function(){return o})),r.d(t,\"j\",(function(){return l})),r.d(t,\"k\",(function(){return c})),r.d(t,\"g\",(function(){return u})),r.d(t,\"h\",(function(){return d})),r.d(t,\"e\",(function(){return p})),r.d(t,\"c\",(function(){return m})),r.d(t,\"b\",(function(){return f})),r.d(t,\"a\",(function(){return h}));var s=r(\"b775\");function a(e){return Object(s[\"a\"])({url:\"/redis/management/\",method:\"get\",params:e})}function n(e){return Object(s[\"a\"])({url:\"/redis/management/\",method:\"post\",data:e})}function i(e){return Object(s[\"a\"])({url:\"/redis/management/\"+e+\"/\",method:\"delete\"})}function o(e){return Object(s[\"a\"])({url:\"/redis/management/\"+e.id+\"/\",method:\"patch\",data:e})}function l(e){return Object(s[\"a\"])({url:\"/redis/ops/get_all_key/\",method:\"post\",data:{id:e}})}function c(e){return Object(s[\"a\"])({url:\"/redis/ops/dbsize/\",method:\"post\",data:{id:e}})}function u(e){return Object(s[\"a\"])({url:\"/redis/ops/get_key/\",method:\"post\",data:{id:e.id,key:e.key}})}function d(e){return Object(s[\"a\"])({url:\"/redis/ops/get_ttl/\",method:\"post\",data:{id:e.id,key:e.key}})}function p(e){return Object(s[\"a\"])({url:\"/redis/ops/del_key/\",method:\"post\",data:{id:e.id,key:e.key}})}function m(e){return Object(s[\"a\"])({url:\"/redis/ops/set_key/\",method:\"post\",data:{id:e.id,key:e.key,value:e.value}})}function f(e){return Object(s[\"a\"])({url:\"/redis/ops/cluster_node/\",method:\"post\",data:{id:e}})}function h(e){return Object(s[\"a\"])({url:\"/redis/ops/cluster_info/\",method:\"post\",data:{id:e}})}},e25a:function(e,t,r){}}]);","extractedComments":[]}