{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-78f5c878\"],{2492:function(e,t,s){\"use strict\";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[s(\"div\",{staticClass:\"crumbs\"},[s(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[s(\"el-breadcrumb-item\",[s(\"i\",{staticClass:\"el-icon-lx-emoji\"}),e._v(\"redis集群操作\")])],1)],1),s(\"div\",{staticClass:\"container\"},[s(\"div\",{staticClass:\"wrapper\"},[s(\"div\",{staticClass:\"grid-one\"},[s(\"div\",{staticClass:\"redis_cluster_select\"},[s(\"div\",{staticClass:\"name_select\"},[s(\"el-tag\",[e._v(\"redis集群选择（cluster_name)\")]),s(\"el-select\",{staticStyle:{width:\"60%\"},attrs:{\"remote-method\":e.remoteSearchRedisClusterName,loading:e.loading,size:\"medium\",filterable:\"\",remote:\"\",clearable:\"\",\"reserve-keyword\":\"\",\"default-first-option\":\"\",placeholder:\"redis集群名关键词选择\"},on:{change:e.setSelectedHosts},model:{value:e.value_cluster_name,callback:function(t){e.value_cluster_name=t},expression:\"value_cluster_name\"}},e._l(e.cluster_options,(function(e){return s(\"el-option\",{key:e.cluster_name,attrs:{label:e.cluster_name,value:e.cluster_name}})})),1)],1),s(\"div\",{staticClass:\"host_select\"},[s(\"el-tag\",[e._v(\"redis集群选择（hosts)\")]),s(\"el-select\",{staticStyle:{width:\"70%\"},attrs:{\"remote-method\":e.remoteSearchRedisClusterHosts,loading:e.loading,size:\"medium\",filterable:\"\",remote:\"\",clearable:\"\",\"reserve-keyword\":\"\",\"default-first-option\":\"\",placeholder:\"redis集群hosts关键词选择\"},on:{change:e.setSelectedClusterName},model:{value:e.value_hosts,callback:function(t){e.value_hosts=t},expression:\"value_hosts\"}},e._l(e.cluster_options,(function(e){return s(\"el-option\",{key:e.hosts,attrs:{label:e.hosts,value:e.hosts}})})),1)],1)])]),s(\"div\",{staticClass:\"grid-two\"},[s(\"el-tag\",{staticStyle:{width:\"90%\",\"text-align\":\"center\"}},[e._v(\"结果输出\")]),s(\"div\",{staticClass:\"reslut\"},[s(\"pre\",[e._v(e._s(e.result_code)),s(\"br\"),e._v(e._s(e.result_msg))])])],1),s(\"div\",{staticClass:\"grid-three\"},[s(\"div\",{staticClass:\"search_all_key\"},[s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handlershowALLKey}},[e._v(\"查看所有key\")]),s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handlershowDBSize}},[e._v(\"查看key数量(dbsize)\")])],1)]),s(\"div\",{staticClass:\"grid-four\"},[s(\"div\",{staticClass:\"get_key_value\"},[s(\"el-collapse\",[s(\"el-collapse-item\",{attrs:{title:\"查询键值\",name:\"1\"}},[s(\"el-input\",{staticStyle:{width:\"40%\"},attrs:{placeholder:\"请输入要查询的键(key)\",clearable:\"\"},model:{value:e.input_key_for_value,callback:function(t){e.input_key_for_value=t},expression:\"input_key_for_value\"}}),s(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:e.handleGetKey}},[e._v(\"开始查询\")])],1),s(\"el-collapse-item\",{attrs:{title:\"TTL查询\",name:\"2\"}},[s(\"el-input\",{staticStyle:{width:\"40%\"},attrs:{placeholder:\"请输入要查询的键(key)\",clearable:\"\"},model:{value:e.input_key_for_ttl,callback:function(t){e.input_key_for_ttl=t},expression:\"input_key_for_ttl\"}}),s(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:e.handleGetKeyTTL}},[e._v(\"开始查询\")])],1),s(\"el-collapse-item\",{attrs:{title:\"删除键-值(key-value)\",name:\"3\"}},[s(\"el-input\",{staticStyle:{width:\"40%\"},attrs:{placeholder:\"请输入要删除的键(key)\",clearable:\"\"},model:{value:e.input_key_for_del,callback:function(t){e.input_key_for_del=t},expression:\"input_key_for_del\"}}),s(\"el-popconfirm\",{attrs:{\"confirm-button-text\":\"好的\",\"cancel-button-text\":\"不用了\",icon:\"el-icon-info\",\"icon-color\":\"red\",title:\"确定删除吗？\"},on:{confirm:e.handleDelKey}},[s(\"el-button\",{attrs:{slot:\"reference\",type:\"danger\"},slot:\"reference\"},[e._v(\"删除\")])],1)],1),s(\"el-collapse-item\",{attrs:{title:\"新建键-值(key-value)\",name:\"4\"}},[s(\"el-input\",{staticStyle:{width:\"40%\"},attrs:{placeholder:\"请输入要新建的键(key)\",clearable:\"\"},model:{value:e.input_key_for_create,callback:function(t){e.input_key_for_create=t},expression:\"input_key_for_create\"}}),s(\"el-input\",{staticStyle:{width:\"40%\"},attrs:{placeholder:\"请输入要新建的值(value)\",clearable:\"\"},model:{value:e.input_value_for_create,callback:function(t){e.input_value_for_create=t},expression:\"input_value_for_create\"}}),s(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:e.handleCreateKey}},[e._v(\"新建\")])],1)],1)],1)])])])])},i=[],n=(s(\"57e7\"),s(\"d25f\"),s(\"7514\"),s(\"6d67\"),s(\"b81b\")),a={name:\"redisOperation\",data:function(){return{cluster_options:[],value_id:this.$store.state.server_id,value_cluster_name:\"\",value_hosts:\"\",cluster_list:[],loading:!1,result_code:\"\",result_msg:\"\",totalNum:0,server:[],input_key_for_value:\"\",input_key_for_ttl:\"\",input_key_for_del:\"\",input_key_for_create:\"\",input_value_for_create:\"\",selected_server_id:null,params:{page:1,keywords:\"\",page_size:10},kwargs:{}}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;Object(n[\"g\"])(this.params).then((function(t){e.server=t.results,e.totalNum=t.count,e.cluster_list=e.server.map((function(e){return{id:\"\".concat(e.id),hosts:\"\".concat(e.hosts),cluster_name:\"\".concat(e.cluster_name)}})),0!==e.$store.state.redis.server_id&&(e.value_cluster_name=e.cluster_list.find((function(t){if(parseInt(t.id)===e.$store.state.redis.server_id)return t})).cluster_name,e.value_hosts=e.cluster_list.find((function(t){if(parseInt(t.id)===e.$store.state.redis.server_id)return t})).hosts)}),(function(t){e.$message({type:\"error\",message:t})}))},remoteSearchRedisClusterName:function(e){var t=this;this.cluster_list=this.server.map((function(e){return{id:\"\".concat(e.id),hosts:\"\".concat(e.hosts),cluster_name:\"\".concat(e.cluster_name)}})),\"\"!==e?(this.loading=!0,setTimeout((function(){t.loading=!1,t.cluster_options=t.cluster_list.filter((function(t){return t.cluster_name.toLowerCase().indexOf(e.toLowerCase())>-1}))}),200)):this.cluster_options=[]},remoteSearchRedisClusterHosts:function(e){var t=this;this.cluster_list=this.server.map((function(e){return{id:\"\".concat(e.id),hosts:\"\".concat(e.hosts),cluster_name:\"\".concat(e.cluster_name)}})),\"\"!==e?(this.loading=!0,setTimeout((function(){t.loading=!1,t.cluster_options=t.cluster_list.filter((function(t){return t.hosts.toLowerCase().indexOf(e.toLowerCase())>-1}))}),200)):this.cluster_options=[]},setSelectedClusterName:function(){var e=this;this.value_cluster_name=this.cluster_options.find((function(t){if(t.hosts===e.value_hosts)return console.log(t.cluster_name),t})).cluster_name},setSelectedHosts:function(){var e=this;this.value_hosts=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).hosts},handlershowALLKey:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,Object(n[\"h\"])(this.value_id).then((function(t){var s=\"\\n\";for(var r in t.msg)s=s+t.msg[r]+\"\\n\";e.result_code=\"返回code：\"+t.code,e.result_msg=\"返回结果：\"+s}),(function(t){e.$message({type:\"error\",message:t})}))},handlershowDBSize:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,Object(n[\"i\"])(this.value_id).then((function(t){var s=\"\\n\";if(t.msg instanceof Object)for(var r in t.msg)s=s+r+\":\\n\",s=s+t.msg[r]+\"\\n\";else s=t.msg;e.result_code=\"返回code：\"+t.code,e.result_msg=\"返回结果：\"+s}),(function(t){e.$message({type:\"error\",message:t})}))},handleGetKey:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,this.kwargs.id=this.value_id,this.kwargs.key=this.input_key_for_value,Object(n[\"e\"])(this.kwargs).then((function(t){e.result_code=\"返回code：\"+t.code,e.result_msg=\"返回结果：\\n\"+t.msg}),(function(t){e.$message({type:\"error\",message:t})}))},handleGetKeyTTL:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,this.kwargs.id=this.value_id,this.kwargs.key=this.input_key_for_ttl,Object(n[\"f\"])(this.kwargs).then((function(t){e.result_code=\"返回code：\"+t.code,e.result_msg=\"返回结果：\"+t.msg}),(function(t){e.$message({type:\"error\",message:t})}))},handleDelKey:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,this.kwargs.id=this.value_id,this.kwargs.key=this.input_key_for_del,Object(n[\"c\"])(this.kwargs).then((function(t){e.result_code=\"返回code：\"+t.code,1===parseInt(t.msg)&&(e.result_msg=\"返回结果：成功删除\"),0===parseInt(t.msg)&&(e.result_msg=\"返回结果：不存在该键\"),parseInt(t.msg)>1&&(e.result_msg=\"返回结果：成功删除\"+t.msg+\"个键\")}),(function(t){e.$message({type:\"error\",message:t})}))},handleCreateKey:function(){var e=this;this.value_id=this.cluster_options.find((function(t){if(t.cluster_name===e.value_cluster_name)return t})).id,this.kwargs.id=this.value_id,this.kwargs.key=this.input_key_for_create,this.kwargs.value=this.input_value_for_create,Object(n[\"a\"])(this.kwargs).then((function(t){console.log(t),e.result_code=\"返回结果：\"+t,e.result_msg=\"\"}),(function(t){e.$message({type:\"error\",message:t})}))}}},l=a,o=(s(\"93d8\"),s(\"2877\")),u=Object(o[\"a\"])(l,r,i,!1,null,\"1b134217\",null);t[\"default\"]=u.exports},\"750b\":function(e,t,s){},\"93d8\":function(e,t,s){\"use strict\";s(\"750b\")},b81b:function(e,t,s){\"use strict\";s.d(t,\"g\",(function(){return i})),s.d(t,\"b\",(function(){return n})),s.d(t,\"d\",(function(){return a})),s.d(t,\"j\",(function(){return l})),s.d(t,\"h\",(function(){return o})),s.d(t,\"i\",(function(){return u})),s.d(t,\"e\",(function(){return c})),s.d(t,\"f\",(function(){return d})),s.d(t,\"c\",(function(){return _})),s.d(t,\"a\",(function(){return f}));var r=s(\"b775\");function i(e){return Object(r[\"a\"])({url:\"/redis/management/\",method:\"get\",params:e})}function n(e){return Object(r[\"a\"])({url:\"/redis/management/\",method:\"post\",data:e})}function a(e){return Object(r[\"a\"])({url:\"/redis/management/\"+e+\"/\",method:\"delete\"})}function l(e){return Object(r[\"a\"])({url:\"/redis/management/\"+e.id+\"/\",method:\"patch\",data:e})}function o(e){return Object(r[\"a\"])({url:\"/redis/ops/get_all_key/\",method:\"post\",data:{id:e}})}function u(e){return Object(r[\"a\"])({url:\"/redis/ops/dbsize/\",method:\"post\",data:{id:e}})}function c(e){return Object(r[\"a\"])({url:\"/redis/ops/get_key/\",method:\"post\",data:{id:e.id,key:e.key}})}function d(e){return Object(r[\"a\"])({url:\"/redis/ops/get_ttl/\",method:\"post\",data:{id:e.id,key:e.key}})}function _(e){return Object(r[\"a\"])({url:\"/redis/ops/del_key/\",method:\"post\",data:{id:e.id,key:e.key}})}function f(e){return Object(r[\"a\"])({url:\"/redis/ops/set_key/\",method:\"post\",data:{id:e.id,key:e.key,value:e.value}})}}}]);","extractedComments":[]}