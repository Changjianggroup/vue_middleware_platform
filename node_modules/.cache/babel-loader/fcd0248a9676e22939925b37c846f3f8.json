{"remainingRequest":"/data/software/vue_middleware_platform/node_modules/thread-loader/dist/cjs.js!/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js!/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/software/vue_middleware_platform/src/components/page/perm/users/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/data/software/vue_middleware_platform/src/components/page/perm/users/index.vue","mtime":1610806795035},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1609060265603},{"path":"/data/software/vue_middleware_platform/node_modules/thread-loader/dist/cjs.js","mtime":1609060265532},{"path":"/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js","mtime":1609060265632},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1609060265603},{"path":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js","mtime":1609060265552}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.map\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getUserList, createUser, updateUser, deleteUser, updateUserGroup, changeUserPass } from '@/api/users';\nimport { getGroupList } from '@/api/groups';\nimport UserList from \"./user-list\";\nimport UserForm from \"./user-form\";\nimport UpdateUserForm from \"./update-user-form\";\nimport UpdateUgroup from \"./update-ugroup\";\nimport ChangePass from \"./change-upass\";\nexport default {\n  name: 'User',\n  components: {\n    UserList: UserList,\n    UserForm: UserForm,\n    UpdateUserForm: UpdateUserForm,\n    UpdateUgroup: UpdateUgroup,\n    ChangePass: ChangePass\n  },\n  data: function data() {\n    return {\n      groupList: [],\n      groupOption: [],\n      user: [],\n      dialogVisibleCreate: false,\n      dialogVisibleUpdate: false,\n      dialogVisibleGroup: false,\n      dialogVisiblePass: false,\n      loading: true,\n      passForm: {},\n      detailForm: {},\n      createString: '立即创建',\n      updateString: '立即更新',\n      totalNum: 0,\n      currentPage1: 1,\n      params: {\n        page: 1,\n        keywords: '',\n        page_size: 10\n      }\n    };\n  },\n  created: function created() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData: function fetchData() {\n      var _this = this;\n\n      getUserList(this.params).then( // 获取user列表信息\n      function (res) {\n        _this.user = res.results;\n        _this.totalNum = res.count;\n        _this.loading = false;\n      }, function (error) {\n        _this.$message({\n          type: 'error',\n          message: error.response.data.detail\n        });\n      });\n    },\n    handleSubmitCreate: function handleSubmitCreate(value) {\n      var _this2 = this;\n\n      // 创建用户\n      createUser(value).then(function () {\n        _this2.fetchData();\n\n        _this2.$refs.userCreateForm.$refs.form.resetFields();\n\n        _this2.dialogVisibleCreate = false;\n\n        _this2.$message({\n          type: 'success',\n          message: '创建成功'\n        });\n      }, function (error) {\n        _this2.$message({\n          type: 'error',\n          message: error.response.data.detail\n        });\n      });\n    },\n    handleSubmitUpdate: function handleSubmitUpdate(value) {\n      var _this3 = this;\n\n      // 更新用户信息\n      updateUser(value).then(function () {\n        _this3.dialogVisibleUpdate = false;\n\n        _this3.fetchData();\n\n        _this3.$message({\n          type: 'success',\n          message: '更新成功'\n        });\n      }, function (error) {\n        _this3.$message({\n          type: 'error',\n          message: error.response.data.detail\n        });\n      });\n    },\n    handleSubmitUpdateUserGroup: function handleSubmitUpdateUserGroup(id, value) {\n      var _this4 = this;\n\n      // 更新用户属组事件\n      updateUserGroup(id, value).then(function () {\n        _this4.dialogVisibleGroup = false;\n\n        _this4.fetchData();\n\n        _this4.$message({\n          type: 'success',\n          message: '更新成功'\n        });\n      }, function (error) {\n        _this4.$message({\n          type: 'error',\n          message: error.response.data.detail\n        });\n      });\n    },\n    handleUpdate: function handleUpdate(value) {\n      // 更新用户弹框显示\n      this.dialogVisibleUpdate = true;\n      this.detailForm = value;\n    },\n    handleUpdateGroup: function handleUpdateGroup(value) {\n      var _this5 = this;\n\n      // 更新用户属组\n      this.groupList = [];\n      this.detailForm = value;\n      this.dialogVisibleGroup = true;\n      getGroupList().then( // 获取所有用户组列表\n      function (res) {\n        _this5.groupOption = res.results;\n      });\n      this.groupList = value.groups.map(function (item) {\n        return item.id;\n      });\n    },\n    handleDelete: function handleDelete(id) {\n      var _this6 = this;\n\n      deleteUser(id).then( // 删除用户\n      function () {\n        if (_this6.totalNum % _this6.params.page_size === 1) {\n          _this6.params.page = _this6.params.page - 1;\n        }\n\n        _this6.fetchData();\n\n        _this6.$message({\n          type: 'success',\n          message: '删除成功!'\n        });\n      }, function (error) {\n        _this6.$message({\n          type: 'error',\n          message: error.response.data.detail\n        });\n      });\n    },\n    handleChangeUserPass: function handleChangeUserPass(id, value) {\n      var _this7 = this;\n\n      // 修改用户密码\n      changeUserPass(id, value).then(function () {\n        _this7.dialogVisiblePass = false;\n\n        _this7.fetchData();\n\n        _this7.$message({\n          type: 'success',\n          message: '修改成功'\n        });\n      }, function (error) {\n        _this7.$message({\n          type: 'error',\n          message: error.response.data\n        });\n      });\n    },\n    handelChangePass: function handelChangePass(value) {\n      // 修改密码弹窗\n      this.dialogVisiblePass = true;\n      this.passForm = value;\n    },\n    handleChangePassCancel: function handleChangePassCancel() {\n      this.dialogVisiblePass = false;\n      this.fetchData();\n    },\n    handleCreateCancel: function handleCreateCancel() {\n      // 创建用户取消按钮\n      this.dialogVisibleCreate = false;\n      this.fetchData();\n    },\n    handleUpdateCancel: function handleUpdateCancel() {\n      // 更新用户取消按钮\n      this.dialogVisibleUpdate = false;\n      this.fetchData();\n    },\n    handleGroupCancel: function handleGroupCancel() {\n      // 更细属组取消按钮\n      this.dialogVisibleGroup = false;\n      this.fetchData();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      // 分页\n      this.params.page = val;\n      this.fetchData();\n    },\n    handleFilter: function handleFilter() {\n      // 搜索\n      this.params.page = 1;\n      this.fetchData();\n    }\n  }\n};",null]}