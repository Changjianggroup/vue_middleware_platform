{"remainingRequest":"/data/software/vue_middleware_platform/node_modules/thread-loader/dist/cjs.js!/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js!/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/software/vue_middleware_platform/src/components/page/perm/groups/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/data/software/vue_middleware_platform/src/components/page/perm/groups/index.vue","mtime":1609055205409},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1609060265603},{"path":"/data/software/vue_middleware_platform/node_modules/thread-loader/dist/cjs.js","mtime":1609060265532},{"path":"/data/software/vue_middleware_platform/node_modules/babel-loader/lib/index.js","mtime":1609060265632},{"path":"/data/software/vue_middleware_platform/node_modules/cache-loader/dist/cjs.js","mtime":1609060265603},{"path":"/data/software/vue_middleware_platform/node_modules/vue-loader/lib/index.js","mtime":1609060265552}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getGroupList, createGroup, updateGroup, deleteGroup, deleteGroupMember, getPermission, updateGroupPerm } from '@/api/groups';\nimport GroupList from \"./group-list\";\nimport GroupForm from \"./group-form\";\nimport GroupMember from \"./group-member\";\nimport GroupPerm from \"./group-perm\";\nexport default {\n  name: 'Group',\n  components: {\n    GroupList: GroupList,\n    GroupForm: GroupForm,\n    GroupMember: GroupMember,\n    GroupPerm: GroupPerm\n  },\n  data: function data() {\n    return {\n      groupForms: [],\n      group: [],\n      member: [],\n      permsList: [],\n      groupname: '',\n      perDialogTitle: '',\n      groupid: '',\n      groupPerms: [],\n      dialogVisibleCreate: false,\n      dialogVisibleUpdate: false,\n      dialogVisibleUser: false,\n      dialogVisiblePerm: false,\n      loading: true,\n      detailForm: {},\n      createString: '立即创建',\n      updateString: '立即更新',\n      totalNum: 0,\n      currentPage1: 1,\n      params: {\n        page: 1,\n        name: '',\n        page_size: 10\n      }\n    };\n  },\n  created: function created() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData: function fetchData() {\n      var _this = this;\n\n      getGroupList(this.params).then( // 获取所有用户组\n      function (res) {\n        _this.group = res.results;\n        _this.totalNum = res.count;\n        _this.loading = false;\n      }, function (err) {\n        _this.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n    },\n    handleSubmitCreate: function handleSubmitCreate(value) {\n      var _this2 = this;\n\n      // 创建用户组\n      createGroup(value).then(function () {\n        _this2.fetchData();\n\n        _this2.$refs.gform.$refs.form.resetFields();\n\n        _this2.dialogVisibleCreate = false;\n\n        _this2.$message({\n          type: 'success',\n          message: '创建成功'\n        });\n      }, function (err) {\n        _this2.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n    },\n    handleSubmitUpdate: function handleSubmitUpdate(value) {\n      var _this3 = this;\n\n      // 编辑更新用户组\n      updateGroup(value).then(function () {\n        _this3.fetchData();\n\n        _this3.dialogVisibleUpdate = false;\n\n        _this3.$message({\n          type: 'success',\n          message: '更新成功'\n        });\n      }, function (err) {\n        _this3.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n    },\n    handleEditPerm: function handleEditPerm(value) {\n      var _this4 = this;\n\n      // 更新用户组的权限\n      this.groupForms = value;\n      this.dialogVisiblePerm = true;\n      getPermission().then(function (res) {\n        _this4.permsList = res;\n      }, function (err) {\n        _this4.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n      this.perDialogTitle = value.name + '组权限修改';\n      this.groupPerms = value.perm.map(function (item) {\n        return item.id;\n      });\n    },\n    handleUpdate: function handleUpdate(value) {\n      // 弹出用户组更新对话框\n      this.dialogVisibleUpdate = true;\n      this.detailForm = value;\n    },\n    handleDelete: function handleDelete(id) {\n      var _this5 = this;\n\n      // 删除用户组\n      deleteGroup(id).then(function () {\n        if (_this5.totalNum % _this5.params.page_size === 1) {\n          _this5.params.page = _this5.params.page - 1;\n        }\n\n        _this5.fetchData();\n\n        _this5.$message({\n          type: 'success',\n          message: '删除成功!'\n        });\n      }, function (err) {\n        _this5.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n    },\n    handleSubmitGroupPerm: function handleSubmitGroupPerm(id, value) {\n      var _this6 = this;\n\n      // 更新用户组权限\n      updateGroupPerm(id, value).then(function () {\n        _this6.dialogVisiblePerm = false;\n\n        _this6.fetchData();\n\n        _this6.$message({\n          type: 'success',\n          message: '更新成功'\n        });\n      });\n      this.$refs.permform.$refs.trans.clearQuery('left');\n      this.$refs.permform.$refs.trans.clearQuery('right');\n    },\n    handlelistMember: function handlelistMember(value) {\n      // 获取用户组成员列表\n      this.groupname = value.name + '组成员列表';\n      this.dialogVisibleUser = true;\n      this.member = value.users;\n      this.groupid = value.id;\n    },\n    handleDeleteGroupMember: function handleDeleteGroupMember(value) {\n      var _this7 = this;\n\n      // 删除用户组成员\n      deleteGroupMember(this.groupid, value).then(function () {\n        _this7.dialogVisibleUser = false;\n\n        _this7.fetchData();\n\n        _this7.$message({\n          type: 'success',\n          message: '删除成功!'\n        });\n      }, function (err) {\n        _this7.$message({\n          type: 'error',\n          message: err.response.data.detail\n        });\n      });\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      // 分页跳转\n      this.params.page = val;\n      this.fetchData();\n    },\n    handleFilter: function handleFilter() {\n      // 用户组搜索功能\n      this.params.page = 1;\n      this.fetchData();\n    },\n    handleCreateCancel: function handleCreateCancel() {\n      // 对话框取消实现\n      this.dialogVisibleCreate = false;\n      this.fetchData();\n    },\n    handleUpdateCancel: function handleUpdateCancel() {\n      // 对话框取消实现\n      this.dialogVisibleUpdate = false;\n      this.fetchData();\n    },\n    handlePermCancel: function handlePermCancel() {\n      // 对话框取消实现\n      this.dialogVisiblePerm = false;\n      this.$refs.permform.$refs.trans.clearQuery('left');\n      this.$refs.permform.$refs.trans.clearQuery('right');\n      this.fetchData();\n    }\n  }\n};",null]}